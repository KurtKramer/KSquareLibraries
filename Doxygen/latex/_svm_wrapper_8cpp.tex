\hypertarget{_svm_wrapper_8cpp}{}\section{C\+:/\+Users/\+Kurt/\+Git\+Hub/\+K\+Square\+Libraries/\+K\+K\+Machine\+Learning/\+Svm\+Wrapper.cpp File Reference}
\label{_svm_wrapper_8cpp}\index{C\+:/\+Users/\+Kurt/\+Git\+Hub/\+K\+Square\+Libraries/\+K\+K\+Machine\+Learning/\+Svm\+Wrapper.\+cpp@{C\+:/\+Users/\+Kurt/\+Git\+Hub/\+K\+Square\+Libraries/\+K\+K\+Machine\+Learning/\+Svm\+Wrapper.\+cpp}}


Provides an interface to the \hyperlink{svm_8cpp}{svm.\+cpp} functions.  


{\ttfamily \#include \char`\"{}First\+Includes.\+h\char`\"{}}\\*
{\ttfamily \#include $<$algorithm$>$}\\*
{\ttfamily \#include $<$ctype.\+h$>$}\\*
{\ttfamily \#include \char`\"{}float.\+h\char`\"{}}\\*
{\ttfamily \#include $<$fstream$>$}\\*
{\ttfamily \#include $<$iostream$>$}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include $<$map$>$}\\*
{\ttfamily \#include $<$numeric$>$}\\*
{\ttfamily \#include $<$ostream$>$}\\*
{\ttfamily \#include $<$set$>$}\\*
{\ttfamily \#include $<$sstream$>$}\\*
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$string$>$}\\*
{\ttfamily \#include $<$time.\+h$>$}\\*
{\ttfamily \#include $<$vector$>$}\\*
{\ttfamily \#include \char`\"{}Memory\+Debug.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}K\+K\+Base\+Types.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}O\+Sservices.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Svm\+Wrapper.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}K\+K\+M\+L\+L\+Types.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}svm.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{_svm_wrapper_8cpp_ac35c76ff5632479d21272251b078a1d4}{Malloc}~(type,n) (type $\ast$)malloc((n)$\ast$sizeof(type))
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_svm_wrapper_8cpp_aaec82eeb18378f8dd1a66ed4f939d1f6}{Compute\+Prob} (\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} num\+Classes, const \hyperlink{namespace_k_k_b_a4820c3670ee1fe74f0c4de981c600faf}{Vector\+Float} \&prob\+Class\+Pairs, vector$<$ double $>$ \&dist, double $\ast$$\ast$cross\+Class\+Prob\+Table, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} $\ast$votes, double $\ast$probabilities, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} known\+Class\+Num)
\item 
void \hyperlink{_svm_wrapper_8cpp_a3017fd2a61b9f40e9c07a4a94c122492}{Compute\+Prob\+For\+Voting} (\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} num\+Classes, float A, vector$<$ double $>$ \&dist, double $\ast$$\ast$cross\+Class\+Prob\+Table, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} $\ast$votes, double $\ast$probabilities, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} known\+Class\+Num, double confidence, double \&compact)
\item 
{\footnotesize template$<$class T $>$ }\\\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} \hyperlink{_svm_wrapper_8cpp_a70a2b90ed254fe355bb702c6000efcea}{Get\+Max\+Index} (vector$<$ T $>$ \&vote, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} vote\+Length, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} \&max\+Index2)
\item 
{\footnotesize template$<$class T $>$ }\\\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} \hyperlink{_svm_wrapper_8cpp_a6ff364432be16b2c76b49d8110b8602a}{Get\+Max\+Index} (T $\ast$vote, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} vote\+Length, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} \&max\+Index2)
\item 
bool \hyperlink{_svm_wrapper_8cpp_a2b5e635dd200402d65005dc037401594}{Greater\+Than} (\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} left\+Votes, double left\+Prob, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} right\+Votes, double right\+Prob)
\item 
void \hyperlink{_svm_wrapper_8cpp_aadbaba3ac0546d7e1c01c0a41c58036a}{Greater\+Votes} (bool use\+Probability, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} num\+Classes, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} $\ast$votes, double $\ast$probabilities, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} \&pred1\+Idx, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} \&pred2\+Idx)
\item 
void \hyperlink{_svm_wrapper_8cpp_a411212db6a24bc494d6258174e2adbb2}{Normalize\+Probabilities\+With\+A\+Minumum} (\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} num\+Classes, double $\ast$probabilities, double min\+Probability)
\begin{DoxyCompactList}\small\item\em Will normailize probabilites such that the sum of all equal 1.\+0 and no one probability will be less than \textquotesingle{}min\+Probability\textquotesingle{}. \end{DoxyCompactList}\item 
void \hyperlink{_svm_wrapper_8cpp_aec4eb891b83528df3570941210d03af0}{save\+Data} (\hyperlink{struct_s_v_m233_1_1svm__problem}{svm\+\_\+problem} ds, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} begin, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} end, std\+::string name)
\item 
void \hyperlink{_svm_wrapper_8cpp_a739187bf3d7ab635291ebf634ada93ef}{save\+Data} (\hyperlink{struct_s_v_m233_1_1svm__problem}{svm\+\_\+problem} ds, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} begin, \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} end, string name)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Provides an interface to the \hyperlink{svm_8cpp}{svm.\+cpp} functions. 



\subsection{Macro Definition Documentation}
\index{Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}!Malloc@{Malloc}}
\index{Malloc@{Malloc}!Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}}
\subsubsection[{\texorpdfstring{Malloc}{Malloc}}]{\setlength{\rightskip}{0pt plus 5cm}\#define Malloc~(type,n) (type $\ast$)malloc((n)$\ast$sizeof(type))}\hypertarget{_svm_wrapper_8cpp_ac35c76ff5632479d21272251b078a1d4}{}\label{_svm_wrapper_8cpp_ac35c76ff5632479d21272251b078a1d4}


Definition at line 53 of file Svm\+Wrapper.\+cpp.



\subsection{Function Documentation}
\index{Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}!Compute\+Prob@{Compute\+Prob}}
\index{Compute\+Prob@{Compute\+Prob}!Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}}
\subsubsection[{\texorpdfstring{Compute\+Prob(kkint32 num\+Classes, const Vector\+Float \&prob\+Class\+Pairs, vector$<$ double $>$ \&dist, double $\ast$$\ast$cross\+Class\+Prob\+Table, kkint32 $\ast$votes, double $\ast$probabilities, kkint32 known\+Class\+Num)}{ComputeProb(kkint32 numClasses, const VectorFloat &probClassPairs, vector< double > &dist, double **crossClassProbTable, kkint32 *votes, double *probabilities, kkint32 knownClassNum)}}]{\setlength{\rightskip}{0pt plus 5cm}void Compute\+Prob (
\begin{DoxyParamCaption}
\item[{{\bf kkint32}}]{num\+Classes, }
\item[{const {\bf Vector\+Float} \&}]{prob\+Class\+Pairs, }
\item[{vector$<$ double $>$ \&}]{dist, }
\item[{double $\ast$$\ast$}]{cross\+Class\+Prob\+Table, }
\item[{{\bf kkint32} $\ast$}]{votes, }
\item[{double $\ast$}]{probabilities, }
\item[{{\bf kkint32}}]{known\+Class\+Num}
\end{DoxyParamCaption}
)}\hypertarget{_svm_wrapper_8cpp_aaec82eeb18378f8dd1a66ed4f939d1f6}{}\label{_svm_wrapper_8cpp_aaec82eeb18378f8dd1a66ed4f939d1f6}


Definition at line 472 of file Svm\+Wrapper.\+cpp.


\begin{DoxyCode}
480 \{
481   \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32}  i;
482   \textcolor{keywordflow}{for}  (i = 0;  i < numClasses;  i++)
483     votes[i] = 0;
484 
485    \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} distIdx = 0;
486    \textcolor{keywordflow}{for}  (i = 0;  i < (numClasses - 1); i++)
487    \{
488      \textcolor{keywordflow}{for}  (\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} j = i + 1;  j < numClasses;  j++)
489      \{
490        \textcolor{keywordflow}{if}  (dist[distIdx] > 0)
491          votes[i]++;
492        \textcolor{keywordflow}{else}
493          votes[j]++;
494 
495        \textcolor{keywordtype}{double} tempProb = (double)(1.0 / (1.0 + exp (-1.0 * probClassPairs[distIdx] * dist[distIdx])));
496        crossClassProbTable[i][j] = tempProb;
497        crossClassProbTable[j][i] = (1.0 - tempProb);
498        distIdx++;
499      \}
500    \}
501 
502    \textcolor{keywordtype}{double}  totalProb = 0.0;
503    \textcolor{keywordflow}{for}  (i = 0;  i < numClasses;  i++)
504    \{
505      \textcolor{keywordtype}{double}  probThisClass = 1.0;
506      \textcolor{keywordflow}{for}  (\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} j = 0;  j < numClasses;  j++)
507      \{
508        \textcolor{keywordflow}{if}  (i != j)
509          probThisClass *= crossClassProbTable [i][j];
510      \}
511 
512      probabilities[i] = probThisClass;
513      totalProb += probThisClass;
514    \}
515 
516    \textcolor{keywordflow}{if}  (totalProb == 0.0)
517    \{
518      \textcolor{comment}{// I think this happens because we are using float pfor probTable and double for dist[]}
519      \textcolor{comment}{// For now we will give each class an equal probability.}
520      \textcolor{keywordflow}{for}  (i = 0; i < numClasses; i++)
521        probabilities[i] = (1.0 / \textcolor{keywordtype}{double}(numClasses));
522    \}
523    \textcolor{keywordflow}{else}
524    \{
525      \textcolor{keywordflow}{for}  (i = 0;  i < numClasses;  i++)
526        probabilities[i] = probabilities[i] / totalProb;
527    \}
528 
529    \textcolor{keywordflow}{if}  ((knownClassNum >= 0) &&  (knownClassNum < numClasses))
530    \{
531      \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} maxIndex1 = -1;
532      \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} maxIndex2 = -1;
533      maxIndex1 = \hyperlink{_svm_wrapper_8cpp_a70a2b90ed254fe355bb702c6000efcea}{GetMaxIndex} (probabilities, numClasses, maxIndex2);
534    \}
535    \textcolor{comment}{//NormalizeProbabilitiesWithAMinumum (numClasses, probabilities, 0.002);}
536 \}  \textcolor{comment}{/* ComputeProb */}
\end{DoxyCode}
\index{Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}!Compute\+Prob\+For\+Voting@{Compute\+Prob\+For\+Voting}}
\index{Compute\+Prob\+For\+Voting@{Compute\+Prob\+For\+Voting}!Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}}
\subsubsection[{\texorpdfstring{Compute\+Prob\+For\+Voting(kkint32 num\+Classes, float A, vector$<$ double $>$ \&dist, double $\ast$$\ast$cross\+Class\+Prob\+Table, kkint32 $\ast$votes, double $\ast$probabilities, kkint32 known\+Class\+Num, double confidence, double \&compact)}{ComputeProbForVoting(kkint32 numClasses, float A, vector< double > &dist, double **crossClassProbTable, kkint32 *votes, double *probabilities, kkint32 knownClassNum, double confidence, double &compact)}}]{\setlength{\rightskip}{0pt plus 5cm}void Compute\+Prob\+For\+Voting (
\begin{DoxyParamCaption}
\item[{{\bf kkint32}}]{num\+Classes, }
\item[{float}]{A, }
\item[{vector$<$ double $>$ \&}]{dist, }
\item[{double $\ast$$\ast$}]{cross\+Class\+Prob\+Table, }
\item[{{\bf kkint32} $\ast$}]{votes, }
\item[{double $\ast$}]{probabilities, }
\item[{{\bf kkint32}}]{known\+Class\+Num, }
\item[{double}]{confidence, }
\item[{double \&}]{compact}
\end{DoxyParamCaption}
)}\hypertarget{_svm_wrapper_8cpp_a3017fd2a61b9f40e9c07a4a94c122492}{}\label{_svm_wrapper_8cpp_a3017fd2a61b9f40e9c07a4a94c122492}

\begin{DoxyParams}{Parameters}
{\em num\+Classes} & Number of Classes. \\
\hline
{\em A} & probability parameter \\
\hline
{\em dist} & Distances for each binary classifier from decision boundary. \\
\hline
{\em cross\+Class\+Prob\+Table} & Two dimensional array that is \textquotesingle{}num\+Class\textquotesingle{} by \textquotesingle{}num\+Class\textquotesingle{}; will receive the probabilities between classes. \\
\hline
{\em votes} & Array \textquotesingle{}num\+Classes\textquotesingle{} in length that will receive the number of Votes each class won. \\
\hline
{\em probabilities} & Array \textquotesingle{}num\+Classes\textquotesingle{} in length that will receive the computed Probability for Each Class \\
\hline
{\em known\+Class\+Num} & The Class that we know the example to be. \\
\hline
{\em confidence} & Used for calculating \textquotesingle{}compact\textquotesingle{} probability must exceed this. \\
\hline
{\em compact} & \textquotesingle{}known\+Class\+Num\textquotesingle{} and \textquotesingle{}confidence\textquotesingle{} need to be provided. \\
\hline
\end{DoxyParams}


Definition at line 287 of file Svm\+Wrapper.\+cpp.


\begin{DoxyCode}
297 \{
298   compact = 0.0;
299 
300   \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} i;
301   \textcolor{keywordflow}{for}  (i = 0;  i < numClasses;  i++)
302     votes[i] = 0;
303 
304    \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} distIdx = 0;
305    \textcolor{keywordflow}{for}  (i = 0;  i < (numClasses - 1); i++)
306    \{
307      \textcolor{keywordflow}{for}  (\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} j = i + 1;  j < numClasses;  j++)
308      \{
309        \textcolor{keywordflow}{if}  (dist[distIdx] > 0)
310          votes[i]++;
311        \textcolor{keywordflow}{else}
312          votes[j]++;
313 
314        crossClassProbTable[i][j] = 0.0;
315        crossClassProbTable[j][i] = 0.0;
316 
317        distIdx++;
318      \}
319    \}
320 
321    \textcolor{keywordtype}{int}  win1 = -1;
322    \textcolor{keywordtype}{int}  win2 = -1;
323    \textcolor{keywordtype}{int}  win3 = -1;
324    \textcolor{keywordtype}{int}  win4 = -1;
325 
326    \textcolor{keywordtype}{int}  win1Idx = 0;
327    \textcolor{keywordtype}{int}  win2Idx = 0;
328    \textcolor{keywordtype}{int}  win3Idx = 0;
329    \textcolor{keywordtype}{int}  win4Idx = 0;
330 
331    \textcolor{keywordflow}{for}  (i = 0;  i < numClasses;  ++i)
332    \{
333      \textcolor{keywordtype}{int}  zed = votes[i];
334      \textcolor{keywordflow}{if}  (zed >= win4)
335      \{
336        win4 = zed;
337        win4Idx = i;
338 
339        \textcolor{keywordflow}{if}  (win4 >= win3)
340        \{
341          win4 = win3;
342          win4Idx = win3Idx;
343          win3 = zed;
344          win3Idx = i;
345 
346          \textcolor{keywordflow}{if}  (win3 >= win2)
347          \{
348            win3 = win2;
349            win3Idx = win2Idx;
350            win2 = zed;
351            win2Idx = i;
352 
353            \textcolor{keywordflow}{if}  (win2 >= win1)
354            \{
355              win2 = win1;
356              win2Idx = win1Idx;
357              win1 = zed;
358              win1Idx = i;
359            \}
360          \}
361        \}
362      \}
363    \}
364 
365    \textcolor{keywordflow}{if}  (win1 == win2)
366    \{
367      \textcolor{keywordflow}{if}  (win1 == win3)
368      \{
369        \textcolor{keywordflow}{if}  (win1 == win4)
370        \{
371          probabilities[win1Idx] = 0.25;
372          probabilities[win2Idx] = 0.25;
373          probabilities[win3Idx] = 0.25;
374          probabilities[win4Idx] = 0.25;
375        \}
376        \textcolor{keywordflow}{else}
377        \{
378          probabilities[win1Idx] = 0.95 / 3.0;
379          probabilities[win2Idx] = 0.95 / 3.0;
380          probabilities[win3Idx] = 0.95 / 3.0;
381          probabilities[win4Idx] = 0.05;
382        \}
383      \}
384      \textcolor{keywordflow}{else}
385      \{
386        probabilities[win1Idx] = 0.85 / 2.0;
387        probabilities[win2Idx] = 0.85 / 2.0;
388        probabilities[win3Idx] = 0.10;
389        probabilities[win4Idx] = 0.05;
390      \}
391    \}
392 
393    \textcolor{keywordflow}{else} 
394    \{
395      probabilities[win1Idx] = 0.65;
396      \textcolor{keywordflow}{if}  (win2 == win3)
397      \{
398        \textcolor{keywordflow}{if}  (win2 == win4)
399        \{
400          probabilities[win2Idx] = 0.30 / 3.0;
401          probabilities[win3Idx] = 0.30 / 3.0;
402          probabilities[win4Idx] = 0.30 / 3.0;
403        \}
404        \textcolor{keywordflow}{else}
405        \{
406          probabilities[win2Idx] = 0.30 / 2.0;
407          probabilities[win3Idx] = 0.30 / 2.0;
408          probabilities[win4Idx] = 0.05;
409        \}
410      \}
411 
412      \textcolor{keywordflow}{else}
413      \{
414        probabilities[win2Idx] = 0.20;
415        \textcolor{keywordflow}{if}  (win3 == win4)
416        \{
417          probabilities[win3Idx] = 0.15 / 2.0;
418          probabilities[win4Idx] = 0.15 / 2.0;
419        \}
420        \textcolor{keywordflow}{else}
421        \{
422          probabilities[win3Idx] = 0.10;
423          probabilities[win4Idx] = 0.05;
424        \}
425      \}
426    \}
427 
428    \textcolor{comment}{//NormalizeProbabilitiesWithAMinumum (numClasses, probabilities, 0.001);}
429 
430    \textcolor{keywordflow}{for}  (i = 0;  i < numClasses;  ++i)
431    \{
432      crossClassProbTable [win1Idx][i] = probabilities[win1Idx];
433      crossClassProbTable [i][win1Idx] = 1.0 - probabilities[win1Idx];
434      \textcolor{keywordflow}{if}  (i != win1Idx)
435      \{
436        crossClassProbTable [win2Idx][i] = probabilities[win2Idx];
437        crossClassProbTable [i][win2Idx] = 1.0 - probabilities[win2Idx];
438        \textcolor{keywordflow}{if}  (i != win2Idx)
439        \{
440          crossClassProbTable [win3Idx][i] = probabilities[win3Idx];
441          crossClassProbTable [i][win3Idx] = 1.0 - probabilities[win3Idx];
442          \textcolor{keywordflow}{if}  (i != win3Idx)
443          \{
444            crossClassProbTable [win4Idx][i] = probabilities[win4Idx];
445            crossClassProbTable [i][win4Idx] = 1.0 - probabilities[win4Idx];
446          \}
447        \}
448      \}
449    \}
450 
451    \textcolor{keywordflow}{if}  ((knownClassNum >= 0) &&  (knownClassNum < numClasses))
452    \{
453      \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} maxIndex1 = -1;
454      \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} maxIndex2 = -1;
455      maxIndex1 = \hyperlink{_svm_wrapper_8cpp_a70a2b90ed254fe355bb702c6000efcea}{GetMaxIndex} (probabilities, numClasses, maxIndex2);
456 
457      \textcolor{keywordflow}{if}  (probabilities[maxIndex1] >= confidence)
458      \{
459        \textcolor{keywordflow}{if}  ((probabilities[knownClassNum] < 1.0f)  &&  (probabilities[knownClassNum] > 0.0f))
460        \{
461          compact = -log ((\textcolor{keywordtype}{double})probabilities[knownClassNum]);
462        \}
463      \}
464    \}
465 \}  \textcolor{comment}{/* ComputeProbForVoting */}
\end{DoxyCode}
\index{Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}!Get\+Max\+Index@{Get\+Max\+Index}}
\index{Get\+Max\+Index@{Get\+Max\+Index}!Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}}
\subsubsection[{\texorpdfstring{Get\+Max\+Index(vector$<$ T $>$ \&vote, kkint32 vote\+Length, kkint32 \&max\+Index2)}{GetMaxIndex(vector< T > &vote, kkint32 voteLength, kkint32 &maxIndex2)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class T $>$ {\bf kkint32} Get\+Max\+Index (
\begin{DoxyParamCaption}
\item[{vector$<$ T $>$ \&}]{vote, }
\item[{{\bf kkint32}}]{vote\+Length, }
\item[{{\bf kkint32} \&}]{max\+Index2}
\end{DoxyParamCaption}
)}\hypertarget{_svm_wrapper_8cpp_a70a2b90ed254fe355bb702c6000efcea}{}\label{_svm_wrapper_8cpp_a70a2b90ed254fe355bb702c6000efcea}


Definition at line 67 of file Svm\+Wrapper.\+cpp.


\begin{DoxyCode}
71 \{
72   T \hyperlink{_usf_cas_cor_8h_ab95f7757e11b270d27b95ec0d8e798b5}{max}=vote[0];
73   \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} maxIndex=0;
74 
75   T  max2 = 0;
76   maxIndex2 = -1;
77 
78   \textcolor{keywordflow}{for}  (\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} i = 1;  i < voteLength;  i++)
79   \{
80     \textcolor{keywordflow}{if}  (vote[i]> max)
81     \{
82       max2      = \hyperlink{_usf_cas_cor_8h_ab95f7757e11b270d27b95ec0d8e798b5}{max};
83       maxIndex2 = maxIndex;
84       max       = vote[i];
85       maxIndex  = i;
86     \}
87 
88     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}  (maxIndex2 < 0)
89     \{
90       max2      = vote[i];
91       maxIndex2 = i;
92     \}
93 
94     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}  (vote[i] > max2)
95     \{
96       max2 = vote[i];
97       maxIndex2 = i;
98     \}
99   \}
100 
101   \textcolor{keywordflow}{return} maxIndex;
102 \}  \textcolor{comment}{/* GetMaxIndex */}
\end{DoxyCode}
\index{Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}!Get\+Max\+Index@{Get\+Max\+Index}}
\index{Get\+Max\+Index@{Get\+Max\+Index}!Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}}
\subsubsection[{\texorpdfstring{Get\+Max\+Index(\+T $\ast$vote, kkint32 vote\+Length, kkint32 \&max\+Index2)}{GetMaxIndex(T *vote, kkint32 voteLength, kkint32 &maxIndex2)}}]{\setlength{\rightskip}{0pt plus 5cm}template$<$class T $>$ {\bf kkint32} Get\+Max\+Index (
\begin{DoxyParamCaption}
\item[{T $\ast$}]{vote, }
\item[{{\bf kkint32}}]{vote\+Length, }
\item[{{\bf kkint32} \&}]{max\+Index2}
\end{DoxyParamCaption}
)}\hypertarget{_svm_wrapper_8cpp_a6ff364432be16b2c76b49d8110b8602a}{}\label{_svm_wrapper_8cpp_a6ff364432be16b2c76b49d8110b8602a}


Definition at line 108 of file Svm\+Wrapper.\+cpp.


\begin{DoxyCode}
112 \{
113   T \hyperlink{_usf_cas_cor_8h_ab95f7757e11b270d27b95ec0d8e798b5}{max}=vote[0];
114   \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} maxIndex=0;
115 
116   T  max2 = 0;
117   maxIndex2 = -1;
118 
119   \textcolor{keywordflow}{for}  (\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} i = 1;  i < voteLength;  i++)
120   \{
121     \textcolor{keywordflow}{if}  (vote[i]> max)
122     \{
123       max2      = \hyperlink{_usf_cas_cor_8h_ab95f7757e11b270d27b95ec0d8e798b5}{max};
124       maxIndex2 = maxIndex;
125       max       = vote[i];
126       maxIndex  = i;
127     \}
128 
129     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}  (maxIndex2 < 0)
130     \{
131       max2      = vote[i];
132       maxIndex2 = i;
133     \}
134 
135     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}  (vote[i] > max2)
136     \{
137       max2 = vote[i];
138       maxIndex2 = i;
139     \}
140   \}
141 
142   \textcolor{keywordflow}{return} maxIndex;
143 \}  \textcolor{comment}{/* GetMaxIndex */}
\end{DoxyCode}
\index{Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}!Greater\+Than@{Greater\+Than}}
\index{Greater\+Than@{Greater\+Than}!Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}}
\subsubsection[{\texorpdfstring{Greater\+Than(kkint32 left\+Votes, double left\+Prob, kkint32 right\+Votes, double right\+Prob)}{GreaterThan(kkint32 leftVotes, double leftProb, kkint32 rightVotes, double rightProb)}}]{\setlength{\rightskip}{0pt plus 5cm}bool Greater\+Than (
\begin{DoxyParamCaption}
\item[{{\bf kkint32}}]{left\+Votes, }
\item[{double}]{left\+Prob, }
\item[{{\bf kkint32}}]{right\+Votes, }
\item[{double}]{right\+Prob}
\end{DoxyParamCaption}
)}\hypertarget{_svm_wrapper_8cpp_a2b5e635dd200402d65005dc037401594}{}\label{_svm_wrapper_8cpp_a2b5e635dd200402d65005dc037401594}


Definition at line 151 of file Svm\+Wrapper.\+cpp.



Referenced by Greater\+Votes().


\begin{DoxyCode}
156 \{
157   \textcolor{keywordflow}{if}  (leftVotes < rightVotes)
158     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
159 
160   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}  (leftVotes > rightVotes)
161     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
162 
163   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}  (leftProb < rightProb)
164     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
165   
166   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}  (leftProb > rightProb)
167     \textcolor{keywordflow}{return}  \textcolor{keyword}{true};
168   
169   \textcolor{keywordflow}{else}
170     \textcolor{keywordflow}{return}  \textcolor{keyword}{false};
171 \}  \textcolor{comment}{/* GreaterThan */}
\end{DoxyCode}
\index{Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}!Greater\+Votes@{Greater\+Votes}}
\index{Greater\+Votes@{Greater\+Votes}!Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}}
\subsubsection[{\texorpdfstring{Greater\+Votes(bool use\+Probability, kkint32 num\+Classes, kkint32 $\ast$votes, double $\ast$probabilities, kkint32 \&pred1\+Idx, kkint32 \&pred2\+Idx)}{GreaterVotes(bool useProbability, kkint32 numClasses, kkint32 *votes, double *probabilities, kkint32 &pred1Idx, kkint32 &pred2Idx)}}]{\setlength{\rightskip}{0pt plus 5cm}void Greater\+Votes (
\begin{DoxyParamCaption}
\item[{bool}]{use\+Probability, }
\item[{{\bf kkint32}}]{num\+Classes, }
\item[{{\bf kkint32} $\ast$}]{votes, }
\item[{double $\ast$}]{probabilities, }
\item[{{\bf kkint32} \&}]{pred1\+Idx, }
\item[{{\bf kkint32} \&}]{pred2\+Idx}
\end{DoxyParamCaption}
)}\hypertarget{_svm_wrapper_8cpp_aadbaba3ac0546d7e1c01c0a41c58036a}{}\label{_svm_wrapper_8cpp_aadbaba3ac0546d7e1c01c0a41c58036a}


Definition at line 175 of file Svm\+Wrapper.\+cpp.



References Greater\+Than().



Referenced by K\+K\+M\+L\+L\+::\+Svm\+Predict\+Class().


\begin{DoxyCode}
182 \{
183   \textcolor{keywordflow}{if}  (useProbability)
184   \{
185     pred1Idx = \hyperlink{_svm_wrapper_8cpp_a70a2b90ed254fe355bb702c6000efcea}{GetMaxIndex} (probabilities, numClasses, pred2Idx);
186     \textcolor{keywordflow}{return};
187   \}
188 
189   \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} max1Votes = votes[0];
190   \textcolor{keywordtype}{double}  max1Prob  = probabilities[0];
191   pred1Idx = 0;
192 
193   \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} max2Votes = -1;
194   \textcolor{keywordtype}{double}  max2Prob  = -1.0f;
195   pred2Idx = -1;
196 
197   \textcolor{keywordflow}{for}  (\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} x = 1;  x < numClasses;  x++)
198   \{
199     \textcolor{keywordflow}{if}  (\hyperlink{_svm_wrapper_8cpp_a2b5e635dd200402d65005dc037401594}{GreaterThan} (votes[x], probabilities[x], max1Votes, max1Prob))
200     \{
201       max2Votes = max1Votes;
202       max2Prob  = max1Prob;
203       pred2Idx  = pred1Idx;
204       max1Votes = votes[x];
205       max1Prob  = probabilities[x];
206       pred1Idx = x;
207     \}
208     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}  ((pred2Idx < 0)  ||  \hyperlink{_svm_wrapper_8cpp_a2b5e635dd200402d65005dc037401594}{GreaterThan} (votes[x], probabilities[x], max2Votes, max2Prob))
209     \{
210       max2Votes = votes[x];
211       max2Prob  = probabilities[x];
212       pred2Idx = x;
213     \}
214   \}
215 \} \textcolor{comment}{/* GreaterVotes*/}
\end{DoxyCode}
\index{Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}!Normalize\+Probabilities\+With\+A\+Minumum@{Normalize\+Probabilities\+With\+A\+Minumum}}
\index{Normalize\+Probabilities\+With\+A\+Minumum@{Normalize\+Probabilities\+With\+A\+Minumum}!Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}}
\subsubsection[{\texorpdfstring{Normalize\+Probabilities\+With\+A\+Minumum(kkint32 num\+Classes, double $\ast$probabilities, double min\+Probability)}{NormalizeProbabilitiesWithAMinumum(kkint32 numClasses, double *probabilities, double minProbability)}}]{\setlength{\rightskip}{0pt plus 5cm}void Normalize\+Probabilities\+With\+A\+Minumum (
\begin{DoxyParamCaption}
\item[{{\bf kkint32}}]{num\+Classes, }
\item[{double $\ast$}]{probabilities, }
\item[{double}]{min\+Probability}
\end{DoxyParamCaption}
)}\hypertarget{_svm_wrapper_8cpp_a411212db6a24bc494d6258174e2adbb2}{}\label{_svm_wrapper_8cpp_a411212db6a24bc494d6258174e2adbb2}


Will normailize probabilites such that the sum of all equal 1.\+0 and no one probability will be less than \textquotesingle{}min\+Probability\textquotesingle{}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em num\+Classes} & Number of classes represented in array \textquotesingle{}probabilities\textquotesingle{}. \\
\hline
\mbox{\tt in,out}  & {\em probabilities} & Probabilites that are to be adjusted. \\
\hline
\mbox{\tt in}  & {\em min\+Probability} & Smallest probablity that any one class can have assigned to it. \\
\hline
\end{DoxyParams}


Definition at line 255 of file Svm\+Wrapper.\+cpp.


\begin{DoxyCode}
259 \{
260   \textcolor{keywordtype}{double}  sumGreaterOrEqualMin = 0.0;
261   \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} numLessThanMin = 0;
262 
263   \hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} x = 0;
264   \textcolor{keywordflow}{for}  (x = 0;  x < numClasses;  ++x)
265   \{
266     \textcolor{keywordflow}{if}  (probabilities[x] < minProbability)
267       ++numLessThanMin;
268     \textcolor{keywordflow}{else}
269       sumGreaterOrEqualMin += probabilities[x];
270   \}
271 
272   \textcolor{keywordtype}{double} probLessMinTotal = numLessThanMin * minProbability;
273   \textcolor{keywordtype}{double} probLeftToAllocate  = 1.0 - probLessMinTotal;  
274 
275   \textcolor{keywordflow}{for}  (x = 0;  x < numClasses;  ++x)
276   \{
277     \textcolor{keywordflow}{if}  (probabilities[x] < minProbability)
278       probabilities[x] = minProbability;
279     \textcolor{keywordflow}{else}
280       probabilities[x] = (probabilities[x] / sumGreaterOrEqualMin) * probLeftToAllocate;
281   \}
282 \}  \textcolor{comment}{/* NormalizeProbabilitiesWithAMinumum */}
\end{DoxyCode}
\index{Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}!save\+Data@{save\+Data}}
\index{save\+Data@{save\+Data}!Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}}
\subsubsection[{\texorpdfstring{save\+Data(svm\+\_\+problem ds, kkint32 begin, kkint32 end, std\+::string name)}{saveData(svm_problem ds, kkint32 begin, kkint32 end, std::string name)}}]{\setlength{\rightskip}{0pt plus 5cm}void save\+Data (
\begin{DoxyParamCaption}
\item[{{\bf svm\+\_\+problem}}]{ds, }
\item[{{\bf kkint32}}]{begin, }
\item[{{\bf kkint32}}]{end, }
\item[{std\+::string}]{name}
\end{DoxyParamCaption}
)}\hypertarget{_svm_wrapper_8cpp_aec4eb891b83528df3570941210d03af0}{}\label{_svm_wrapper_8cpp_aec4eb891b83528df3570941210d03af0}
\index{Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}!save\+Data@{save\+Data}}
\index{save\+Data@{save\+Data}!Svm\+Wrapper.\+cpp@{Svm\+Wrapper.\+cpp}}
\subsubsection[{\texorpdfstring{save\+Data(svm\+\_\+problem ds, kkint32 begin, kkint32 end, string name)}{saveData(svm_problem ds, kkint32 begin, kkint32 end, string name)}}]{\setlength{\rightskip}{0pt plus 5cm}void save\+Data (
\begin{DoxyParamCaption}
\item[{{\bf svm\+\_\+problem}}]{ds, }
\item[{{\bf kkint32}}]{begin, }
\item[{{\bf kkint32}}]{end, }
\item[{string}]{name}
\end{DoxyParamCaption}
)}\hypertarget{_svm_wrapper_8cpp_a739187bf3d7ab635291ebf634ada93ef}{}\label{_svm_wrapper_8cpp_a739187bf3d7ab635291ebf634ada93ef}


Definition at line 223 of file Svm\+Wrapper.\+cpp.



References S\+V\+M233\+::svm\+\_\+node\+::index, and S\+V\+M233\+::svm\+\_\+problem\+::x.


\begin{DoxyCode}
228 \{
229   ofstream out(name.c\_str());
230   \textcolor{keywordflow}{if}(!out.good())
231   \{
232     cout << \textcolor{stringliteral}{" cannot open "} << name << \hyperlink{namespace_k_k_b_ad1f50f65af6adc8fa9e6f62d007818a8}{endl};
233     exit(-1);
234   \}
235   \textcolor{keywordflow}{for}(\hyperlink{namespace_k_k_b_a8fa4952cc84fda1de4bec1fbdd8d5b1b}{kkint32} i=begin; i<end; i++)
236   \{
237     \hyperlink{struct_s_v_m233_1_1svm__node}{svm\_node}* temp=ds.\hyperlink{struct_s_v_m233_1_1svm__problem_a79a6083544d0f446a643167950c7e285}{x}[i];
238     \textcolor{keywordflow}{while}(temp->\hyperlink{struct_s_v_m233_1_1svm__node_a3c4e097d4f2ba8091128a9b605fcaa12}{index}!=-1)
239     \{
240       out << temp->\hyperlink{struct_s_v_m233_1_1svm__node_abc3f1df2ce88e0759c7f3fe74eefcf0d}{value} << \textcolor{stringliteral}{","};
241       temp++;
242     \}
243     out << ds.\hyperlink{struct_s_v_m233_1_1svm__problem_a0883e07a3006cd2bb31eeb61c3a8c453}{y}[i] << \hyperlink{namespace_k_k_b_ad1f50f65af6adc8fa9e6f62d007818a8}{endl};
244   \}
245   out.close();
246 \}
\end{DoxyCode}
